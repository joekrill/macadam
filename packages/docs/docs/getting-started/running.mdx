---
sidebar_position: 1
---

# Running

## Prerequisites

The only prerequisite to getting a fully-usable environment up and running is [Docker](https://www.docker.com/) and [Docker Compose](https://docs.docker.com/compose/install/).

### Starting a development environment

1. Clone the repo (i.e. `git clone https://github.com/joekrill/macadam.git`)
2. Run `docker compose up` from the root directory.

The resulting web application will be accessible by visiting <https://localtest.me> in your browser.

Development tooling is also available:

- https://mail.localtest.me - maildev instance which intercepts all mail sent.
- https://pgweb.localtest.me - pgweb for interacting with the underlying database
- https://kratos.localtest.me - direct access to the Kratos public API
- https://kratos-admin.localtest.me - direct access to the Kratos admin API
- https://kratos-courier.localtest.me - direct access to the Kratos instance running Courier

Additional tooling may also be available when using [additional docker-compose configurations](#running-additional-services):

- https://storybook.localtest.me - pgweb for interacting with the underlying database
- https://glitchtip.localtest.me - pgweb for interacting with the underlying database
- https://plausible.localtest.me - pgweb for interacting with the underlying database
- https://prometheus.localtest.me - pgweb for interacting with the underlying database
- https://grafana.localtest.me - pgweb for interacting with the underlying database

## TLS

The auto-generated certificates will not be trusted by default and you will need to manually trust them. Alternatively, you can add the underlying Caddy certificate authority as a trusted root on your local machine.

```sh

# On MacOS
docker cp $(docker-compose ps -q caddy):/data/caddy/pki/authorities/local/root.crt /tmp/macadam_caddy.crt && sudo security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /tmp/macadam_caddy.crt

# On Linux
docker cp $(docker-compose ps -q caddy):/data/caddy/pki/authorities/local/root.crt /usr/local/share/ca-certificates/macadam_caddy.crt && sudo update-ca-certificates

# Firefox on MacOS - `security.enterprise_roots.enabled` must be `true` in `about:config` (see https://support.mozilla.org/en-US/kb/setting-certificate-authorities-firefox for other OSes)
docker cp $(docker compose ps -q caddy):/data/caddy/pki/authorities/local/root.crt ~/Library/Application\ Support/Mozilla/Certificates/macadam_caddy.crt

```

## Running additional services

Some services are not run by default in the development environment. These can be include by using the appropriate compose configurations alongside the default `docker-compose.yml`. For example, to run a Storybook instance:

```sh
docker compose -f docker-compose.yml docker-compose.storybook.yml up
```

Available additional services:

- `docker-compose.analytics.yml` runs a Plausible Analytics instance and it's depdenencies.
- `docker-compose.error-tracking.yml` runs a GlitchTip instance for collecting crash and error reports.
- `docker-compose.metrics.yml` runs Prometheus and Grafana instances.
- `docker-compose.storybook.yml` runs a Storybook instance for explorting the web application UI components.
